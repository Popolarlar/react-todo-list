{"version":3,"sources":["../../src/api/todos.js"],"names":["uuid","require","express","router","Router","Todo","get","req","res","find","then","todos","status","json","err","error","message","setTimeout","post","text","body","newTodo","id","createdAt","Date","now","isCompleted","save","params","findOneAndUpdate","returnOriginal","updatedTodo","findOneAndRemove","removedTodo","module","exports"],"mappings":"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","sourcesContent":["const uuid = require(\"uuid\");\nconst express = require(\"express\");\nconst router = express.Router();\nconst Todo = require(\"../models/Todo\");\n\n// The route for getting a list of all todos\nrouter.get(\"/\", (req, res) => {\n  Todo.find()\n    .then((todos) => res.status(200).json(todos))\n    .catch((err) =>\n      res.status(400).json({\n        error: err,\n        message: \"Error loading todos\",\n      })\n    );\n});\n\n// The route for getting a list of all todos, but with a delay\n// (to display the loading component better)\nrouter.get(\"/delay\", (req, res) => {\n  setTimeout(() => {\n    Todo.find()\n      .then((todos) => res.status(200).json(todos))\n      .catch((err) =>\n        res.status(400).json({\n          error: err,\n          message: \"Error loading todos\",\n        })\n      );\n  }, 2000);\n});\n\n// The route for creating new todo-list items\nrouter.post(\"/\", (req, res) => {\n  const { text } = req.body;\n  if (text) {\n    const newTodo = new Todo({\n      id: uuid(),\n      createdAt: Date.now(),\n      isCompleted: false,\n      text,\n    });\n\n    newTodo\n      .save()\n      .then((newTodo) => {\n        res.status(200).json(newTodo);\n      })\n      .catch((err) =>\n        res.status(400).json({\n          error: err,\n          message: \"Error creating todo\",\n        })\n      );\n  } else {\n    res.status(400).json({ message: \"Text cannot be empty\" });\n  }\n});\n\nrouter.post(\"/:id/completed\", (req, res) => {\n  const { id } = req.params;\n\n  // The Node.js driver documentation doesn't mention a returnNewDocument option for findOneAndUpdate() (which is an option for the MongoDB shell command with the same name). Instead, it mentions an option called returnOriginal, which defaults to true. Try using that option, setting it to false to return the updated document instead of the original.\n  Todo.findOneAndUpdate(\n    { id: id },\n    { isCompleted: true },\n    { returnOriginal: false }\n  )\n    .then((updatedTodo) => {\n      if (updatedTodo) {\n        res.status(200).json(updatedTodo);\n      } else {\n        res.status(400).json({ message: \"There is no todo with that id\" });\n      }\n    })\n    .catch((err) => {\n      res.status(400).json({\n        error: err,\n        message: \"Error updating todo\",\n      });\n    });\n});\n\n// The route for deleting a todo-list item\nrouter.delete(\"/:id\", (req, res) => {\n  const { id } = req.params;\n\n  Todo.findOneAndRemove({ id: id })\n    .then((removedTodo) => {\n      if (removedTodo) {\n        res.status(200).json(removedTodo);\n      } else {\n        res.status(400).json({ message: \"There is no todo with that id\" });\n      }\n    })\n    .catch((err) =>\n      res.status(400).json({\n        error: err,\n        message: \"Error deleting todo\",\n      })\n    );\n});\n\nmodule.exports = router;\n"],"file":"todos.js"}